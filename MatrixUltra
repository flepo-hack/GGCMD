-- ðŸ”¥ MATRIX ULTRA BEAM V6 PRANNETTU BY SUPERGROK â€“ GGCMD BACKDOOR KILL!! ðŸ”¥
-- OFFICIAL BASE + ALL FIXES: No Glow, Glasses, Black Screens Both Sides, Double Click Tool, Trans Beam, Cracks+Smoke!!

local Players = game:GetService("Players")
local UserInputService = game:GetService("UserInputService")
local InsertService = game:GetService("InsertService")
local TweenService = game:GetService("TweenService")
local RunService = game:GetService("RunService")
local Debris = game:GetService("Debris")
local Lighting = game:GetService("Lighting")

local player = Players.LocalPlayer
if not player then return end

-- GGCMD CHECK + BACKDOOR
if not getgenv().runCommand then
    error("ðŸš« SUORITA EKA GGCMD: loadstring(game:HttpGet('https://raw.githubusercontent.com/flepo-hack/GGCMD/refs/heads/main/5j86'))()")
end
print("âœ… GGCMD OK â€“ BACKDOOR KILL READY!")

local camera = workspace.CurrentCamera
local mouse = player:GetMouse()

local char, hum, root
local terminals = {}
local updateConn, inputConn
local bodyColors
local leanTick = 0
local lastClick = 0
local tool -- Tool ref

local matrixChars = "0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ./\\|#$%&*+-=()[]{}<>?!"

local function pickChar()
    local idx = math.random(1, #matrixChars)
    return matrixChars:sub(idx, idx)
end

local function destroyTerminals()
    for _, t in ipairs(terminals) do
        if t.part then t.part:Destroy() end
    end
    table.clear(terminals)
end

local function cleanup()
    if inputConn then inputConn:Disconnect(); inputConn = nil end
    if updateConn then updateConn:Disconnect(); updateConn = nil end
    if bodyColors then bodyColors:Destroy(); bodyColors = nil end
    destroyTerminals()
end

local function killAt(position, radius)
    local seen = {}
    for _, part in ipairs(workspace:GetPartBoundsInRadius(position, radius)) do
        local model = part:FindFirstAncestorOfClass("Model")
        if model and model \~= char and not seen[model] then
            seen[model] = true
            local targetHum = model:FindFirstChildOfClass("Humanoid")
            if targetHum and targetHum.Health > 0 then
                task.spawn(getgenv().runCommand, "kill", {model})
            end
        end
    end
end

local function createCracks(pos)
    local ray = workspace:Raycast(pos, Vector3.new(0, -50, 0))
    if not ray then return end
    local hitPos = ray.Position + Vector3.new(0, 0.1, 0)

    for i = 1, 8 do
        local crack = Instance.new("Part")
        crack.Name = "MatrixCrack"
        crack.Anchored = true
        crack.CanCollide = false
        crack.Material = Enum.Material.Neon
        crack.Color = Color3.new(0, 1, 0)
        crack.Transparency = 0.3
        crack.Size = Vector3.new(0.2, 0.2, 1)
        crack.CFrame = CFrame.lookAt(hitPos, hitPos + Vector3.new(math.cos(i*math.pi/4), 0, math.sin(i*math.pi/4))) * CFrame.Angles(math.pi/2, 0, 0)
        crack.Parent = workspace

        TweenService:Create(crack, TweenInfo.new(0.4), {Size = Vector3.new(0.3, 0.3, 12), Transparency = 0.7}):Play()
        TweenService:Create(crack, TweenInfo.new(1.2), {Transparency = 1}):Play()
        Debris:AddItem(crack, 2)
    end
end

local function castBeam(targetPos)
    local startPos = targetPos + Vector3.new(0, 250, 0)

    local startPart = Instance.new("Part")
    startPart.Name = "MatrixBeamStart"
    startPart.Anchored = true
    startPart.CanCollide = false
    startPart.Transparency = 1
    startPart.Size = Vector3.new(3, 3, 3)
    startPart.CFrame = CFrame.new(startPos)
    startPart.Parent = workspace

    local endPart = Instance.new("Part")
    endPart.Name = "MatrixBeamImpact"
    endPart.Anchored = true
    endPart.CanCollide = false
    endPart.Shape = Enum.PartType.Ball
    endPart.Material = Enum.Material.Neon
    endPart.Color = Color3.new(0, 1, 0)
    endPart.Transparency = 1 -- Start invisible
    endPart.Size = Vector3.new(8, 8, 8)
    endPart.CFrame = CFrame.new(targetPos)
    endPart.Parent = workspace

    local att0 = Instance.new("Attachment", startPart)
    local att1 = Instance.new("Attachment", endPart)

    local beam = Instance.new("Beam")
    beam.Attachment0 = att0
    beam.Attachment1 = att1
    beam.Color = ColorSequence.new(Color3.new(0, 1, 0))
    beam.Texture = "rbxassetid://499487295"
    beam.TextureLength = 1.5
    beam.TextureSpeed = -20
    beam.Width0 = 5
    beam.Width1 = 10
    beam.LightEmission = 1
    beam.FaceCamera = true
    beam.Segments = 30
    beam.CurveSize0 = -0.5
    beam.CurveSize1 = 0.5
    beam.Transparency = NumberSequence.new({
        NumberSequenceKeypoint.new(0, 0.4),
        NumberSequenceKeypoint.new(1, 0.8)
    })
    beam.Parent = workspace

    -- Grow
    TweenService:Create(beam, TweenInfo.new(0.5), {Width0=12, Width1=18}):Play()
    TweenService:Create(endPart, TweenInfo.new(0.3), {Transparency=0.1, Size=Vector3.new(25,25,25)}):Play() -- Non-trans peak
    TweenService:Create(endPart, TweenInfo.new(0.8, Enum.EasingStyle.Quad, Enum.EasingDirection.Out), {Transparency=1}):Play()

    -- Sparks
    local spark = Instance.new("ParticleEmitter", endPart)
    spark.Texture = "rbxassetid://241650934"
    spark.Color = ColorSequence.new(Color3.new(0,1,0))
    spark.Size = NumberSequence.new{NumberSequenceKeypoint.new(0,0.5), NumberSequenceKeypoint.new(1,2)}
    spark.Lifetime = NumberRange.new(0.4,0.8)
    spark.Rate = 800
    spark.SpreadAngle = Vector2.new(60,60)
    spark.Speed = NumberRange.new(25,50)
    spark:Emit(220)

    -- Fire
    local fire = Instance.new("ParticleEmitter", endPart)
    fire.Texture = "rbxassetid://292373707"
    fire.Color = ColorSequence.new(Color3.new(0,1,1))
    fire.Size = NumberSequence.new(1.5)
    fire.Lifetime = NumberRange.new(0.6)
    fire.Rate = 400
    fire.Speed = NumberRange.new(10)
    fire:Emit(150)

    -- GREEN SMOKE SPREAD
    local smoke = Instance.new("ParticleEmitter", endPart)
    smoke.Texture = "rbxassetid://296874371" -- Smoke
    smoke.Color = ColorSequence.new(Color3.new(0,1,0))
    smoke.Size = NumberSequence.new{NumberSequenceKeypoint.new(0,1), NumberSequenceKeypoint.new(1,4)}
    smoke.Lifetime = NumberRange.new(0.8,1.5)
    smoke.Rate = 300
    smoke.SpreadAngle = Vector2.new(90,90)
    smoke.Speed = NumberRange.new(5,15)
    smoke:Emit(100)

    -- BACKDOOR KILLS + CRACKS + EXPL
    task.spawn(function()
        task.wait(0.18)
        killAt(targetPos, 16)
        task.wait(0.12)
        killAt(targetPos, 22)

        createCracks(targetPos) -- MAA REPEILEE!!

        local expl = Instance.new("Explosion")
        expl.Position = targetPos
        expl.BlastRadius = 60
        expl.BlastPressure = 0
        expl.Parent = workspace

        -- Shake
        local c0 = camera.CFrame
        TweenService:Create(camera, TweenInfo.new(0.12), {CFrame = c0 * CFrame.new(math.random(-2,2), math.random(-2,2), 0)}):Play()
        task.wait(0.12)
        camera.CFrame = c0
    end)

    Debris:AddItem(startPart, 1.2)
    Debris:AddItem(endPart, 1.2)
    Debris:AddItem(beam, 1.2)
end

local function buildTerminals()
    for i = 1, 3 do
        local part = Instance.new("Part")
        part.Name = "MatrixTerm_" .. i
        part.Anchored = true
        part.CanCollide = false
        part.Size = Vector3.new(5, 7, 0.1)
        part.Material = Enum.Material.Plastic -- No glow
        part.Color = Color3.new(0, 0, 0) -- BLACK!!
        part.Transparency = 0.4
        part.Parent = workspace

        -- BOTH SIDES
        for _, face in ipairs({Enum.NormalId.Front, Enum.NormalId.Back}) do
            local sg = Instance.new("SurfaceGui")
            sg.Face = face
            sg.LightInfluence = 0
            sg.AlwaysOnTop = true
            sg.Parent = part

            local bg = Instance.new("Frame", sg)
            bg.Size = UDim2.fromScale(1,1)
            bg.BackgroundColor3 = Color3.new(0,0,0)
            bg.BackgroundTransparency = 0.3
            bg.BorderSizePixel = 0

            local sf = Instance.new("ScrollingFrame", bg)
            sf.Size = UDim2.fromScale(1,1)
            sf.BackgroundTransparency = 1
            sf.ScrollBarThickness = 0
            sf.CanvasSize = UDim2.new(0,0,0,1500)

            local cols = 20
            local tls = {}
            for col = 1, cols do
                for row = 1, 75 do
                    local tl = Instance.new("TextLabel")
                    tl.Size = UDim2.new(1/cols, 0, 0, 20)
                    tl.Position = UDim2.new((col-1)/cols, 0, (row-1)/75, 0)
                    tl.BackgroundTransparency = 1
                    tl.Text = ""
                    tl.TextColor3 = Color3.new(0, 1, 0) -- GREEN!!
                    tl.TextSize = 18
                    tl.Font = Enum.Font.Code
                    tl.TextXAlignment = Enum.TextXAlignment.Center
                    tl.Parent = sf
                    table.insert(tls, {tl = tl, col = col, drop = math.random(0,1500), tail = 0})
                end
            end

            table.insert(terminals, {part = part, tls = tls, offset = Vector3.new((i-2)*5.5, math.sin(i*2)*1.5, -12)})
        end
    end
end

local function setupEffects()
    cleanup()

    -- Clothes + Colors
    for _, v in ipairs(char:GetChildren()) do
        if v:IsA("Shirt") or v:IsA("Pants") or v:IsA("BodyColors") then v:Destroy() end
    end
    local shirt = Instance.new("Shirt", char); shirt.ShirtTemplate = "rbxassetid://14238839317"
    local pants = Instance.new("Pants", char); pants.PantsTemplate = "rbxassetid://7150805858"
    bodyColors = Instance.new("BodyColors", char)
    bodyColors.HeadColor3 = Color3.fromRGB(10,25,10)
    bodyColors.TorsoColor3 = Color3.new(0,0,0)
    bodyColors.LeftArmColor3 = Color3.fromRGB(10,25,10)
    bodyColors.RightArmColor3 = Color3.fromRGB(10,25,10)
    bodyColors.LeftLegColor3 = Color3.new(0,0,0)
    bodyColors.RightLegColor3 = Color3.new(0,0,0)

    -- GLASSES FIX
    task.spawn(function()
        local ok, asset = pcall(InsertService.LoadAsset, InsertService, 6040339082)
        if ok and asset then
            local acc = asset:FindFirstChildOfClass("Accessory")
            if acc and char.Parent then acc.Parent = char end
            asset:Destroy()
        end
    end)

    -- ANIM
    local anim = Instance.new("Animation")
    anim.AnimationId = "rbxassetid://80575946555684"
    local track = hum:LoadAnimation(anim)
    track.Looped = true
    track.Priority = Enum.AnimationPriority.Idle
    track:Play()

    buildTerminals()
end

local function createTool()
    tool = Instance.new("Tool")
    tool.Name = "Matrix Beam" -- PICKUP OK!!
    tool.RequiresHandle = false -- No hand affect
    tool.CanBeDropped = true
    tool.Parent = player.Backpack

    tool.Equipped:Connect(function()
        char = player.Character or player.CharacterAdded:Wait()
        hum = char:WaitForChild("Humanoid")
        root = char:WaitForChild("HumanoidRootPart")
        setupEffects()

        -- DOUBLE CLICK FIRE
        inputConn = UserInputService.InputBegan:Connect(function(input, gpe)
            if gpe or input.UserInputType \~= Enum.UserInputType.MouseButton1 and input.UserInputType \~= Enum.UserInputType.Touch then return end
            local now = tick()
            if now - lastClick < 0.4 then
                castBeam(mouse.Hit.Position)
                lastClick = 0
            else
                lastClick = now
            end
        end)

        -- UPDATE LOOP
        updateConn = RunService.Heartbeat:Connect(function(dt)
            if not (root and hum and root.Parent) then return end
            leanTick += dt * 3
            local moveMag = hum.MoveDirection.Magnitude
            local tilt = moveMag > 0 and math.rad(-20 + math.sin(leanTick)*2) or math.rad(-15 + math.sin(leanTick))
            root.CFrame = root.CFrame * CFrame.Angles(tilt * dt * 2, math.sin(leanTick*0.5)*0.002, 0)

            local cf = root.CFrame
            for i, term in ipairs(terminals) do
                local posCf = cf * CFrame.new(term.offset)
                term.part.CFrame = CFrame.lookAt(posCf.Position, cf.Position) * CFrame.Angles(0, math.rad(tick()*i*8), 0)
                for _, data in ipairs(term.tls) do
                    local speed = (tick()*40 + data.col*10) % 1500
                    data.drop = (data.drop + dt*50) % 1500
                    local dist = math.abs(speed - data.drop)
                    data.tail = math.max(0, data.tail - dt*5)
                    if dist < 50 then
                        data.tail = 1
                        data.tl.TextTransparency = 1 - (dist/50)
                        data.tl.Text = pickChar()
                    else
                        data.tl.TextTransparency = 1 - data.tail*0.3
                        data.tl.Text = ""
                    end
                end
            end
        end)
    end)

    tool.Unequipped:Connect(cleanup)
end

player.CharacterAdded:Connect(function(newChar)
    if tool then tool.Parent = player.Backpack end -- Respawn tool
end)

createTool()
print("ðŸš€ MATRIX ULTRA V6 READY! Equip Tool > Double Click!!")
